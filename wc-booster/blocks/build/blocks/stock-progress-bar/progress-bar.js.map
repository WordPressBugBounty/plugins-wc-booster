{"version":3,"file":"blocks/stock-progress-bar/progress-bar.js","mappings":"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","sources":["webpack://wc-booster/./src/blocks/stock-progress-bar/progress-bar.js"],"sourcesContent":["(function ($) {\r\n    const VariationProductStockBar = {\r\n        init: function() {\r\n            $( document ).on( 'click', '.wc-booster-swatches-selector a', this.onSwatchClick );\r\n            $( document ).on( 'change', 'select[data-attribute_name]', this.onSelectChange );\r\n        },\r\n\r\n        onSwatchClick: function(e) {\r\n            e.preventDefault();\r\n            VariationProductStockBar.updateStockBar( $( this ) );\r\n        },\r\n\r\n        onSelectChange: function() {\r\n            VariationProductStockBar.updateStockBar( $( this ) );\r\n        },\r\n\r\n        updateStockBar: function( el ) {\r\n            var $wrapper        = el.closest( '.wc_booster_variations' ),\r\n                variation       = JSON.parse( $wrapper.attr( 'data-product_variations' ) ),\r\n                $productWrapper = $wrapper.closest( 'li.product' );\r\n\r\n\r\n            let matchingVariation = {};\r\n\r\n            // Loop through all available variations\r\n            for ( const varData of variation ) {\r\n                let isMatching = true;\r\n\r\n                for ( const [ attr_name, attr_value ] of Object.entries( varData.attributes ) ) {\r\n                    const attributeName = attr_name.replace('attribute_', '');\r\n                    let selectedValue = $wrapper.find( `ul.wc-booster-swatches-selector[data-id=\"${attributeName}\"] li.selected a` ).data( 'value' ) || \r\n                                        $wrapper.find( `select[data-attribute_name=\"attribute_${attributeName}\"]` ).val();\r\n\r\n                    if ( attr_value !== selectedValue ) {\r\n                        isMatching = false;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if ( isMatching ) {\r\n                    matchingVariation = varData;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            var vId = matchingVariation.variation_id;\r\n\r\n            if ( vId ) {\r\n                $.ajax({\r\n                    url: WC_BOOSTER_SPB.ajaxurl,\r\n                    type: 'POST',\r\n                    data: {\r\n                        action: 'get_variation_stock_info',\r\n                        variation_id: vId\r\n                    },\r\n                    success: function( response ) {\r\n                        if ( response.success && matchingVariation.is_in_stock ) {\r\n                            var totalStock = response.data.total_stock,\r\n                                soldStock  = response.data.sold_stock;\r\n\r\n                            var progressPercentage = ( soldStock / ( soldStock + totalStock ) ) * 100;\r\n\r\n                            $productWrapper.find( '.stock-progress-bar-fill' ).css( 'width', progressPercentage + '%' );\r\n                            $productWrapper.find( '.stock-progress-status' ).text( 'Sold: ' + soldStock + ' / ' + ( soldStock + totalStock ) );\r\n                            $productWrapper.find( '.wc-booster-stock-progress-bar-wrapper' ).attr( 'style', 'display: block' );\r\n\r\n                        } else {\r\n                            $productWrapper.find( '.wc-booster-stock-progress-bar-wrapper' ).attr( 'style', 'display: none' );\r\n                            //$productWrapper.find( '.stock-progress-status' ).text('Stock information not available');\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    $( document ).ready( function() {\r\n        VariationProductStockBar.init();\r\n    });\r\n\r\n})(jQuery);\r\n"],"names":["$","VariationProductStockBar","init","document","on","onSwatchClick","onSelectChange","e","preventDefault","updateStockBar","el","$wrapper","closest","variation","JSON","parse","attr","$productWrapper","matchingVariation","varData","isMatching","attr_name","attr_value","Object","entries","attributes","attributeName","replace","selectedValue","find","data","val","vId","variation_id","ajax","url","WC_BOOSTER_SPB","ajaxurl","type","action","success","response","is_in_stock","totalStock","total_stock","soldStock","sold_stock","progressPercentage","css","text","ready","jQuery"],"sourceRoot":""}